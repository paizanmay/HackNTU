<!doctype html>
<html lang="en" ng-app="createOrder">

<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">

<title>新增應繳費用頁面</title>

{% load staticfiles %}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.8/angular.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.8/angular-resource.min.js"></script>
<script type="text/javascript" src="{% static 'js/create_order.js' %}"></script>
<link rel="stylesheet" href="//ichef.github.io/iC-framework/dist/css/ic-framework.min.css">

</head>

<body ng-controller="createOrderCtrl">
    <section class="ic-section" ng-hide="isSuccess">
        <h3 class="ic-section__title">費用資訊</h3>
    
        <div class="ic-section__container">
            <ul class="ic-list ic-list--setting">
                <li class="ic-list__item">
                    <div class="ic-list__item-container">
                        <span class="ic-list__item-body">
                            <span class="ic-list__item-label">
                                費用類別
                            </span>
                            <span class="ic-list__item-value">
                                <select ng-model="orderDetail.order_type">
                                    <option value="2">電費</option>
                                    <option value="1">水費</option>
                                    <option value="3">網路費</option>
                                    <option value="4">雜費</option>
                                </select>
                            </span>
                        </span>
                    </div>
                </li>
                <li class="ic-list__item">
                    <div class="ic-list__item-container">
                        <span class="ic-list__item-body">
                            <span class="ic-list__item-label">
                                備註
                            </span>
                            <span class="ic-list__item-value">
                                <input type="text" ng-model="orderDetail.name">
                            </span>
                        </span>
                    </div>
                </li>
                <li class="ic-list__item">
                    <div class="ic-list__item-container">
                        <span class="ic-list__item-body">
                            <span class="ic-list__item-label">
                                總額
                            </span>
                            <span class="ic-list__item-value">
                                <input type="number" ng-model="orderDetail.amount">
                            </span>
                        </span>
                    </div>
                </li>
                <li class="ic-list__item">
                    <div class="ic-list__item-container">
                        <span class="ic-list__item-body">
                            <span class="ic-list__item-label">
                                繳費期限
                            </span>
                            <span class="ic-list__item-value">
                                <input type="date" ng-model="orderDetail.deadline">
                            </span>
                        </span>
                    </div>
                </li>
            </ul>
        </div>
    </section>

    <!-- <form action="/tenant/tenant_pay_order_success/" method="POST"> -->
    <section class="ic-section" ng-hide="isSuccess">
        <h3 class="ic-section__title">分帳方式</h3>
    
        <div class="ic-section__container">
            <ul class="ic-list ic-list--setting">
                <li class="ic-list__item" ng-repeat="user in userList">
                    <div class="ic-list__item-container">
                        <span class="ic-list__item-body">
                            <span class="ic-list__item-label">
                                {$ $index + 1 $}.{$ user.name $}
                            </span>
                            <span class="ic-list__item-value">
                                <input type="number" ng-model="user.amount">
                            </span>
                        </span>
                    </div>
                </li>
                <li class="ic-list__item">
                    <div class="ic-list__item-container">
                        <span class="ic-list__item-body">
                            <span class="ic-list__item-label">
                                <button class="ic-btn ic-btn--blue" ng-click="allocate()">自動分配</button>
                            </span>
                        </span>
                    </div>
                </li>
            </ul>
        </div>
        <div class="ic-section__container">
            <ul class="ic-list ic-list--setting">
                <li class="ic-list__item">
                    <div class="ic-list__item-container">
                        <span class="ic-list__item-body">
                            <span class="ic-list__item-label">
                                新增費用
                            </span>
                            <span class="ic-list__item-value">
                                <button class="ic-btn ic-btn--blue" type="submit" ng-click="create()">確認</button>
                            </span>
                        </span>
                    </div>
                </li>
            </ul>
        </div>
    </section>
    
<div class="ic-popup ic-popup--blue" ng-if="isPopover">
    <div class="ic-popup__backdrop"></div>
    <div class="ic-popup__container">
        <div class="ic-popup__body">
            <div class="ic-popup__icon" ng-if="isSuccess">
                <i class="ic-icon-success ic-icon--large"></i>
            </div>
            <p class="ic-popup__message" ng-if="isSuccess">
                成功新增代繳費用
            </p>
            <div class="ic-popup__icon" ng-if="!isSuccess">
                <i class="ic-icon-loading ic-icon--large ic-icon--spin"></i>
            </div>
            <p class="ic-popup__message" ng-if="!isSuccess">
                新增待繳費用中...
            </p>
        </div>

        <div class="ic-popup__footer" ng-show="isSuccess">
            <button class="ic-popup__button ic-popup__button--primary" ng-click="closePopup()">OK</button>
        </div>
    </div>
</div>

<script type="text/javascript">
var user_list = [];
var roomUuid = '{{room_uuid}}';
var userUuid = '{{user_uuid}}';

{% for user in room_tenant_list %}
user_list.push(
    {
        "name": '{{user.name}}',
        "uuid": '{{user.uuid}}',
    }
)
{% endfor %}

</script>

</body>
